{"$id":"decision-gate://contract/schemas/config.schema.json","$schema":"https://json-schema.org/draft/2020-12/schema","additionalProperties":false,"description":"Configuration for the Decision Gate MCP server and providers.","properties":{"anchors":{"additionalProperties":false,"properties":{"providers":{"default":[],"items":{"additionalProperties":false,"properties":{"anchor_type":{"description":"Anchor type identifier expected in evidence results.","type":"string"},"provider_id":{"description":"Provider identifier requiring anchors.","type":"string"},"required_fields":{"description":"Required fields inside anchor payload.","items":{"type":"string"},"minItems":1,"type":"array"}},"required":["provider_id","anchor_type","required_fields"],"type":"object"},"type":"array"}},"type":"object"},"dev":{"additionalProperties":false,"properties":{"permissive":{"default":false,"type":"boolean"},"permissive_exempt_providers":{"default":["assetcore_read","assetcore"],"items":{"type":"string"},"type":"array"},"permissive_scope":{"default":"asserted_evidence_only","enum":["asserted_evidence_only"],"type":"string"},"permissive_ttl_days":{"default":null,"oneOf":[{"type":"null"},{"minimum":1,"type":"integer"}]},"permissive_warn":{"default":true,"type":"boolean"}},"type":"object"},"evidence":{"additionalProperties":false,"properties":{"allow_raw_values":{"default":false,"type":"boolean"},"require_provider_opt_in":{"default":true,"type":"boolean"}},"type":"object"},"namespace":{"additionalProperties":false,"properties":{"allow_default":{"default":false,"type":"boolean"},"authority":{"additionalProperties":false,"allOf":[{"if":{"properties":{"mode":{"const":"assetcore_http"}}},"then":{"required":["assetcore"]}},{"if":{"properties":{"mode":{"const":"none"}}},"then":{"properties":{"assetcore":{"type":"null"}}}}],"properties":{"assetcore":{"oneOf":[{"type":"null"},{"additionalProperties":false,"properties":{"auth_token":{"description":"Optional bearer token for namespace lookup.","type":"string"},"base_url":{"description":"Asset Core write-daemon base URL.","type":"string"},"connect_timeout_ms":{"description":"Connect timeout in milliseconds.","minimum":0,"type":"integer"},"mapping":{"additionalProperties":{"minimum":0,"type":"integer"},"default":{},"type":"object"},"mapping_mode":{"default":"numeric_parse","enum":["none","explicit_map","numeric_parse"],"type":"string"},"request_timeout_ms":{"description":"Request timeout in milliseconds.","minimum":0,"type":"integer"}},"required":["base_url"],"type":"object"}]},"mode":{"default":"none","enum":["none","assetcore_http"],"type":"string"}},"type":"object"},"default_tenants":{"default":[],"items":{"description":"Tenant identifier allowed for default namespace.","type":"string"},"type":"array"}},"type":"object"},"policy":{"additionalProperties":false,"allOf":[{"if":{"properties":{"engine":{"const":"static"}}},"then":{"required":["static"]}},{"if":{"properties":{"engine":{"enum":["permit_all","deny_all"]}}},"then":{"properties":{"static":{"type":"null"}}}}],"properties":{"engine":{"default":"permit_all","enum":["permit_all","deny_all","static"],"type":"string"},"static":{"additionalProperties":false,"properties":{"default":{"default":"deny","enum":["permit","deny"],"type":"string"},"rules":{"items":{"additionalProperties":false,"allOf":[{"if":{"properties":{"effect":{"const":"error"}}},"then":{"required":["error_message"]}}],"properties":{"content_types":{"description":"Content types allowed by the rule.","items":{"type":"string"},"type":"array"},"effect":{"enum":["permit","deny","error"],"type":"string"},"error_message":{"description":"Error message when effect is 'error'.","type":"string"},"forbid_labels":{"description":"Visibility labels that must not be present.","items":{"type":"string"},"type":"array"},"forbid_policy_tags":{"description":"Policy tags that must not be present.","items":{"type":"string"},"type":"array"},"packet_ids":{"description":"Packet identifiers allowed by the rule.","items":{"type":"string"},"type":"array"},"require_labels":{"description":"Visibility labels that must be present.","items":{"type":"string"},"type":"array"},"require_policy_tags":{"description":"Policy tags that must be present.","items":{"type":"string"},"type":"array"},"scenario_ids":{"description":"Scenario identifiers allowed by the rule.","items":{"type":"string"},"type":"array"},"schema_ids":{"description":"Schema identifiers allowed by the rule.","items":{"type":"string"},"type":"array"},"stage_ids":{"description":"Stage identifiers allowed by the rule.","items":{"type":"string"},"type":"array"},"target_kinds":{"items":{"enum":["agent","session","external","channel"],"type":"string"},"type":"array"},"targets":{"items":{"additionalProperties":false,"properties":{"system":{"description":"External system name.","type":"string"},"target":{"description":"External target identifier.","type":"string"},"target_id":{"description":"Target identifier for agent/session/channel.","type":"string"},"target_kind":{"enum":["agent","session","external","channel"],"type":"string"}},"required":["target_kind"],"type":"object"},"type":"array"}},"required":["effect"],"type":"object"},"type":"array"}},"type":"object"}},"type":"object"},"providers":{"default":[],"items":{"additionalProperties":false,"allOf":[{"if":{"properties":{"type":{"const":"mcp"}}},"then":{"anyOf":[{"required":["command"]},{"required":["url"]}],"required":["capabilities_path"]}}],"properties":{"allow_insecure_http":{"default":false,"type":"boolean"},"allow_raw":{"default":false,"type":"boolean"},"auth":{"default":null,"oneOf":[{"type":"null"},{"additionalProperties":false,"properties":{"bearer_token":{"oneOf":[{"type":"null"},{"description":"Bearer token for MCP providers.","type":"string"}]}},"type":"object"}]},"capabilities_path":{"default":null,"oneOf":[{"type":"null"},{"description":"Path to provider capability contract JSON.","type":"string"}]},"command":{"default":[],"items":{"type":"string"},"type":"array"},"config":{"description":"Provider-specific config blob.","type":["null","boolean","number","string","array","object"]},"name":{"description":"Provider identifier.","type":"string"},"trust":{"default":null,"oneOf":[{"type":"null"},{"oneOf":[{"default":"audit","enum":["audit"],"type":"string"},{"additionalProperties":false,"properties":{"require_signature":{"additionalProperties":false,"properties":{"keys":{"description":"Signature key identifiers.","items":{"type":"string"},"type":"array"}},"required":["keys"],"type":"object"}},"required":["require_signature"],"type":"object"}]}]},"type":{"enum":["builtin","mcp"],"type":"string"},"url":{"default":null,"oneOf":[{"type":"null"},{"description":"Provider HTTP URL.","type":"string"}]}},"required":["name","type"],"type":"object"},"type":"array"},"run_state_store":{"additionalProperties":false,"allOf":[{"if":{"properties":{"type":{"const":"sqlite"}}},"then":{"required":["path"]}},{"if":{"properties":{"type":{"const":"memory"}}},"then":{"properties":{"path":{"type":"null"}}}}],"properties":{"busy_timeout_ms":{"default":5000,"minimum":0,"type":"integer"},"journal_mode":{"default":"wal","enum":["wal","delete"],"type":"string"},"max_versions":{"default":null,"oneOf":[{"type":"null"},{"minimum":1,"type":"integer"}]},"path":{"default":null,"oneOf":[{"type":"null"},{"description":"Path to the SQLite run state database.","type":"string"}]},"sync_mode":{"default":"full","enum":["full","normal"],"type":"string"},"type":{"default":"memory","enum":["memory","sqlite"],"type":"string"}},"type":"object"},"schema_registry":{"additionalProperties":false,"allOf":[{"if":{"properties":{"type":{"const":"sqlite"}}},"then":{"required":["path"]}},{"if":{"properties":{"type":{"const":"memory"}}},"then":{"properties":{"path":{"type":"null"}}}}],"properties":{"acl":{"additionalProperties":false,"properties":{"default":{"default":"deny","enum":["deny","allow"],"type":"string"},"mode":{"default":"builtin","enum":["builtin","custom"],"type":"string"},"require_signing":{"default":false,"type":"boolean"},"rules":{"default":[],"items":{"additionalProperties":false,"properties":{"actions":{"default":[],"items":{"enum":["register","list","get"],"type":"string"},"type":"array"},"effect":{"enum":["allow","deny"],"type":"string"},"namespaces":{"default":[],"items":{"description":"Namespace identifier.","type":"string"},"type":"array"},"policy_classes":{"default":[],"items":{"type":"string"},"type":"array"},"roles":{"default":[],"items":{"type":"string"},"type":"array"},"subjects":{"default":[],"items":{"type":"string"},"type":"array"},"tenants":{"default":[],"items":{"description":"Tenant identifier.","type":"string"},"type":"array"}},"required":["effect"],"type":"object"},"type":"array"}},"type":"object"},"busy_timeout_ms":{"default":5000,"minimum":0,"type":"integer"},"journal_mode":{"default":"wal","enum":["wal","delete"],"type":"string"},"max_entries":{"default":null,"oneOf":[{"type":"null"},{"minimum":1,"type":"integer"}]},"max_schema_bytes":{"default":1048576,"minimum":1,"type":"integer"},"path":{"default":null,"oneOf":[{"type":"null"},{"description":"Path to the SQLite schema registry database.","type":"string"}]},"sync_mode":{"default":"full","enum":["full","normal"],"type":"string"},"type":{"default":"memory","enum":["memory","sqlite"],"type":"string"}},"type":"object"},"server":{"additionalProperties":false,"allOf":[{"if":{"properties":{"transport":{"enum":["http","sse"]}}},"then":{"properties":{"bind":{"description":"Bind address for HTTP/SSE transport.","type":"string"}},"required":["bind"]}}],"properties":{"audit":{"additionalProperties":false,"properties":{"enabled":{"default":true,"type":"boolean"},"log_precheck_payloads":{"default":false,"type":"boolean"},"path":{"default":null,"oneOf":[{"type":"null"},{"description":"Audit log path (JSON lines).","type":"string"}]}},"type":"object"},"auth":{"additionalProperties":false,"properties":{"allowed_tools":{"default":[],"items":{"type":"string"},"type":"array"},"bearer_tokens":{"default":[],"items":{"type":"string"},"type":"array"},"mode":{"default":"local_only","enum":["local_only","bearer_token","mtls"],"type":"string"},"mtls_subjects":{"default":[],"items":{"type":"string"},"type":"array"},"principals":{"default":[],"items":{"additionalProperties":false,"properties":{"policy_class":{"default":null,"oneOf":[{"type":"null"},{"description":"Policy class label.","type":"string"}]},"roles":{"default":[],"items":{"additionalProperties":false,"properties":{"name":{"description":"Role name.","type":"string"},"namespace_id":{"default":null,"oneOf":[{"type":"null"},{"description":"Namespace identifier scope.","type":"string"}]},"tenant_id":{"default":null,"oneOf":[{"type":"null"},{"description":"Tenant identifier scope.","type":"string"}]}},"required":["name"],"type":"object"},"type":"array"},"subject":{"description":"Principal identifier (subject or token fingerprint).","type":"string"}},"required":["subject"],"type":"object"},"type":"array"}},"type":"object"},"bind":{"default":null,"oneOf":[{"type":"null"},{"description":"Bind address for HTTP/SSE transport.","type":"string"}]},"limits":{"additionalProperties":false,"properties":{"max_inflight":{"default":256,"minimum":1,"type":"integer"},"rate_limit":{"default":null,"oneOf":[{"type":"null"},{"additionalProperties":false,"properties":{"max_entries":{"default":4096,"minimum":1,"type":"integer"},"max_requests":{"default":1000,"minimum":1,"type":"integer"},"window_ms":{"default":1000,"minimum":100,"type":"integer"}},"type":"object"}]}},"type":"object"},"max_body_bytes":{"default":1048576,"minimum":0,"type":"integer"},"mode":{"default":"strict","enum":["strict","dev_permissive"],"type":"string"},"tls":{"additionalProperties":false,"properties":{"cert_path":{"description":"Server TLS certificate (PEM).","type":"string"},"client_ca_path":{"default":null,"oneOf":[{"type":"null"},{"description":"Optional client CA bundle for mTLS.","type":"string"}]},"key_path":{"description":"Server TLS private key (PEM).","type":"string"},"require_client_cert":{"default":true,"type":"boolean"}},"type":"object"},"transport":{"default":"stdio","enum":["stdio","http","sse"],"type":"string"}},"type":"object"},"trust":{"additionalProperties":false,"properties":{"default_policy":{"oneOf":[{"default":"audit","enum":["audit"],"type":"string"},{"additionalProperties":false,"properties":{"require_signature":{"additionalProperties":false,"properties":{"keys":{"description":"Signature key identifiers.","items":{"type":"string"},"type":"array"}},"required":["keys"],"type":"object"}},"required":["require_signature"],"type":"object"}]},"min_lane":{"description":"Trust lane classification for evidence.","enum":["verified","asserted"],"type":"string"}},"type":"object"}},"title":"Decision Gate MCP Configuration","type":"object"}